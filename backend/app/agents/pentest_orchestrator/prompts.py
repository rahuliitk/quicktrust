"""Prompt templates for the pentest orchestrator agent."""

SYSTEM_PROMPT = """You are an expert penetration testing consultant with extensive experience in
web application security, cloud infrastructure testing, and network security assessments.
You follow OWASP Testing Guide, PTES (Penetration Testing Execution Standard), and NIST SP 800-115
methodologies. You create thorough test plans and generate realistic findings based on
organizational context. You do NOT execute actual penetration tests -- you generate realistic
simulated test plans and findings for assessment and planning purposes."""

GENERATE_TEST_PLAN_PROMPT = """Based on the following organizational context, create a structured
penetration test plan.

Organization Context:
- Industry: {industry}
- Company Size: {company_size}
- Cloud Providers: {cloud_providers}
- Tech Stack: {tech_stack}
- Total Controls: {total_controls}
- Security Controls Summary: {controls_summary}

Generate a comprehensive penetration test plan that covers:
1. Scope definition (what will be tested)
2. Testing methodology (based on OWASP, PTES)
3. Test categories with specific test cases for each:
   - Web Application Testing (OWASP Top 10)
   - API Security Testing
   - Cloud Infrastructure Testing (specific to their cloud providers)
   - Network Security Testing
   - Authentication & Authorization Testing
   - Data Protection Testing
4. Timeline estimate
5. Tools that would be used (for reference)

Return a JSON object with key "test_plan" containing:
"scope" (object with "in_scope" array and "out_of_scope" array),
"methodology" (string),
"categories" (array of objects with "name", "description", "test_cases" array of objects
with "id", "title", "description", "severity_if_found", "owasp_category"),
"timeline_days" (integer),
"tools_referenced" (array of strings)."""

SIMULATE_FINDINGS_PROMPT = """Based on the following organization context and test plan, generate
realistic simulated penetration test findings. These are NOT from actual tests but represent
likely findings given the organization's technology stack and security posture.

Organization Context:
- Industry: {industry}
- Cloud Providers: {cloud_providers}
- Tech Stack: {tech_stack}
- Controls Summary: {controls_summary}

Test Plan Summary:
{test_plan_json}

Generate 5-10 realistic findings that would be typical for an organization with this profile.
Include a mix of severities. Each finding should be specific to their tech stack.

For each finding, provide:
1. A clear, specific title
2. Detailed description of the vulnerability
3. Severity: "critical", "high", "medium", "low", "informational"
4. CVSS score estimate (0.0-10.0)
5. Affected component (specific to their tech stack)
6. Steps to reproduce (simulated)
7. Remediation recommendation
8. OWASP category if applicable
9. Business impact description

Return a JSON object with key "findings" containing an array of objects, each with:
"title", "description", "severity", "cvss_score", "affected_component",
"steps_to_reproduce" (array of strings), "remediation", "owasp_category",
"business_impact"."""
